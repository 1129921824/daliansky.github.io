<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="AppleALC,AppleHDA,声卡仿冒," />





  <link rel="alternate" href="/rss2.xml" title="黑果小兵的部落阁" type="application/atom+xml" />






<meta name="description" content="大纲,写作中前言经常给网友仿冒声卡驱动, 一直都没有将过程写下来,鉴于每天会有许多人问如何仿冒声卡,就想将过程记录下来,供大家参考学习 提取codec通过linux提取codec制作Ubuntu Linux启动U盘: 下载Ubuntu Linux镜像,可以选择国内开源镜像站点下载:网易 搜狐 阿里云    如果你只是想通过Linux提取codec的话,可以随便下载个旧的版本即可,比如这个ubunt">
<meta name="keywords" content="AppleALC,AppleHDA,声卡仿冒">
<meta property="og:type" content="article">
<meta property="og:title" content="使用AppleALC声卡仿冒驱动AppleHDA的正确姿势">
<meta property="og:url" content="http://blog.daliansky.net/Use-AppleALC-sound-card-to-drive-the-correct-posture-of-AppleHDA.html">
<meta property="og:site_name" content="黑果小兵的部落阁">
<meta property="og:description" content="大纲,写作中前言经常给网友仿冒声卡驱动, 一直都没有将过程写下来,鉴于每天会有许多人问如何仿冒声卡,就想将过程记录下来,供大家参考学习 提取codec通过linux提取codec制作Ubuntu Linux启动U盘: 下载Ubuntu Linux镜像,可以选择国内开源镜像站点下载:网易 搜狐 阿里云    如果你只是想通过Linux提取codec的话,可以随便下载个旧的版本即可,比如这个ubunt">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/diskutil_disk4.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/Boot_select.jpg">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/Ubuntu_boot.jpg">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/ubuntu1.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/ubuntu_codec_and_DSDT.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/SelectAudioDevice.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/SoundInputDeviceSelect.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/codec.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/node_output.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/node_input.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/node12_pathmap.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/PlistEditorPro.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/little-endian.jpg">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/pinconfigs.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/ALC_Folder.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/ALC256_Info.plist.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/Platforms_edit2.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/ioreg_pinconfigurations.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/path1.png">
<meta property="og:image" content="http://ous2s14vo.bkt.clouddn.com/path2.png">
<meta property="og:updated_time" content="2017-12-08T02:41:09.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用AppleALC声卡仿冒驱动AppleHDA的正确姿势">
<meta name="twitter:description" content="大纲,写作中前言经常给网友仿冒声卡驱动, 一直都没有将过程写下来,鉴于每天会有许多人问如何仿冒声卡,就想将过程记录下来,供大家参考学习 提取codec通过linux提取codec制作Ubuntu Linux启动U盘: 下载Ubuntu Linux镜像,可以选择国内开源镜像站点下载:网易 搜狐 阿里云    如果你只是想通过Linux提取codec的话,可以随便下载个旧的版本即可,比如这个ubunt">
<meta name="twitter:image" content="http://ous2s14vo.bkt.clouddn.com/diskutil_disk4.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.daliansky.net/Use-AppleALC-sound-card-to-drive-the-correct-posture-of-AppleHDA.html"/>





  <title>使用AppleALC声卡仿冒驱动AppleHDA的正确姿势 | 黑果小兵的部落阁</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    
    <a href="https://github.com/daliansky"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">黑果小兵的部落阁</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Daliansky的空中楼阁</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.daliansky.net/Use-AppleALC-sound-card-to-drive-the-correct-posture-of-AppleHDA.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="DalianSky">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="黑果小兵的部落阁">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">使用AppleALC声卡仿冒驱动AppleHDA的正确姿势</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-09T09:23:23+08:00">
                2017-11-09
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2017-12-08T10:41:09+08:00">
                2017-12-08
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/教程/" itemprop="url" rel="index">
                    <span itemprop="name">教程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/Use-AppleALC-sound-card-to-drive-the-correct-posture-of-AppleHDA.html" class="leancloud_visitors" data-flag-title="使用AppleALC声卡仿冒驱动AppleHDA的正确姿势">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">热度&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
                 <span class="post-meta-item-text">℃</span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7,744 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  33 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="大纲-写作中"><a href="#大纲-写作中" class="headerlink" title="大纲,写作中"></a>大纲,写作中</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>经常给网友仿冒声卡驱动, 一直都没有将过程写下来,鉴于每天会有许多人问如何仿冒声卡,就想将过程记录下来,供大家参考学习</p>
<h1 id="提取codec"><a href="#提取codec" class="headerlink" title="提取codec"></a>提取codec</h1><h2 id="通过linux提取codec"><a href="#通过linux提取codec" class="headerlink" title="通过linux提取codec"></a>通过linux提取codec</h2><h3 id="制作Ubuntu-Linux启动U盘"><a href="#制作Ubuntu-Linux启动U盘" class="headerlink" title="制作Ubuntu Linux启动U盘:"></a>制作Ubuntu Linux启动U盘:</h3><ul>
<li>下载Ubuntu Linux镜像,可以选择国内开源镜像站点下载:<br><a href="http://mirrors.163.com/ubuntu-releases/" target="_blank" rel="external">网易</a> <a href="http://mirrors.sohu.com/ubuntu-releases/" target="_blank" rel="external">搜狐</a> <a href="https://mirrors.aliyun.com/ubuntu-releases/" target="_blank" rel="external">阿里云</a> </li>
</ul>
<blockquote>
<p>如果你只是想通过Linux提取codec的话,可以随便下载个旧的版本即可,比如这个<a href="https://mirrors.aliyun.com/ubuntu-releases/14.04/ubuntu-14.04.5-desktop-amd64.iso" target="_blank" rel="external">ubuntu 14.04.5LTS</a>,如果想作为日后的生产力工具的话,我推荐你下载最新发布的<a href="https://mirrors.aliyun.com/ubuntu-releases/17.10/ubuntu-17.10-desktop-amd64.iso" target="_blank" rel="external">ubuntu 17.10</a></p>
</blockquote>
<h4 id="制作Ubuntu-Linux安装盘"><a href="#制作Ubuntu-Linux安装盘" class="headerlink" title="制作Ubuntu Linux安装盘"></a>制作Ubuntu Linux安装盘</h4><ul>
<li>Windows下请使用工具<code>UltraISO</code>,方法略</li>
<li><p>macOS下制作过程:</p>
<ul>
<li><p>插入U盘,确定设备名,方法为打开磁盘工具,选择U盘,可以看到U盘下面有两个分区:<code>disk4s1</code>和<code>disk4s2</code>,那么U盘的设备名就是:<code>disk4</code><img src="http://ous2s14vo.bkt.clouddn.com/diskutil_disk4.png" alt="diskutil_disk4"></p>
</li>
<li><p>当然最简单的方法还是直接使用命令查看:<code>diskutil list</code>,输出的信息为:</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">/dev/disk4 (internal, physical):</div><div class="line">  <span class="comment">#:                  TYPE NAME      SIZE IDENTIFIER</span></div><div class="line">  0:     Apple_partition_scheme   *2.0 GB disk4</div><div class="line">  1:        Apple_partition_map    4.1 KB disk4s1</div><div class="line">  2:                  Apple_HFS    2.4 MB disk4s2</div></pre></td></tr></table></figure>
<p>这个<code>disk4</code>就是你要操作的设备名,后面我们会用到它</p>
</li>
<li><p>卸载U盘,准备写入镜像,输入命令:<br>  <code>diskutil umountDisk disk4</code> # 卸载U盘</p>
</li>
<li><p>使用<code>dd</code>命令将下载的Ubuntu Linux镜像恢复到U盘上,操作之前我有必要<strong>提醒各位小白,万一你不小心输入错了设备名,那么你连哭的机会都没有,因为dd是按扇区直接物理写入磁盘,别到时候找不到数据了再悔不当初没有认真看到这段文字</strong></p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo dd <span class="keyword">if</span>=/Users/sky/Downloads/ISO/ubuntu-17.10-desktop-amd64.iso of=/dev/disk4 bs=1m</div></pre></td></tr></table></figure>
</code></pre><p>  命令输入完后,请仔细认真检查下,尤其是<code>of=/dev/disk4</code>这里,再三确认后回车执行,输入用户密码后请耐心等待6-7分钟,写盘速度取决于你的U盘,镜像恢复的过程中不会有任何的文字输出,U盘写入成功后会显示下面类似的输出信息:</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">~ % diskutil umountDisk disk4</div><div class="line">Unmount of all volumes on disk4 was successful</div><div class="line">~ % sudo dd <span class="keyword">if</span>=/Users/sky/Downloads/ISO/ubuntu-17.10-desktop-amd64.iso of=/dev/disk4 bs=1m</div><div class="line">Password:</div><div class="line">1431+1 records <span class="keyword">in</span></div><div class="line">1431+1 records out</div><div class="line">1501102080 bytes transferred <span class="keyword">in</span> 906.101477 secs (1656660 bytes/sec)</div></pre></td></tr></table></figure>

*我的U盘竟然写了906秒(15分钟),我先找个地方哭会儿去*
同时系统会弹出一个警告窗口,显示类似的信息:
![dd_error](http://ous2s14vo.bkt.clouddn.com/dd_error.png)

那是因为Linux的分区格式是ext,在macOS系统下无法识别才会报错,但是其实一个支持UEFI引导的Ubuntu Linux 17.10启动U盘已经制作成功了.点击`Ignore`忽略或者`Eject`退出U盘
</code></pre></li>
</ul>
</li>
<li>现在您可以使用这个新制作的Ubuntu Linux安装U盘引导Linux去提取codec</li>
</ul>
<h2 id="提取codec-1"><a href="#提取codec-1" class="headerlink" title="提取codec"></a>提取codec</h2><p>开机按引导设备快捷键<code>F12</code>或者<code>F8</code>进入引导设备选单,选择<code>Ubuntu Linux</code>所在的USB盘回车<br><img src="http://ous2s14vo.bkt.clouddn.com/Boot_select.jpg" alt="Boot_select"><br>出现Ubuntu Linux的引导界面,选择<code>Try Ubuntu without installing</code>,该选项可以在不安装的情况下试用Ubuntu<br><img src="http://ous2s14vo.bkt.clouddn.com/Ubuntu_boot.jpg" alt="Ubuntu_boot"><br>回车后稍候会进入Ubuntu桌面:<br><img src="http://ous2s14vo.bkt.clouddn.com/ubuntu1.png" alt="ubuntu1"><br>按组合键<code>CTRL+ALT+t</code>打开终端,输入以下命令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ~/Desktop/ <span class="comment"># 进入用户桌面</span></div><div class="line">cp /proc/asound/card0/codec<span class="comment">#0 . # 将codec#0复制到当时位置</span></div><div class="line">sudo cp -R /sys/firmware/acpi/tables .  <span class="comment"># 将acpi/tables目录复制到当时位置,tables目录包括了全部的DSDT和SSDT</span></div><div class="line">ls -l   <span class="comment"># 列表</span></div><div class="line">sudo chown -R ubuntu:ubuntu *   <span class="comment"># 将当前目录下所有文件及目录所有人修改为ubuntu</span></div><div class="line">ls -l   <span class="comment"># 列表</span></div></pre></td></tr></table></figure>
<p>显示输出信息如下:<br><img src="http://ous2s14vo.bkt.clouddn.com/ubuntu_codec_and_DSDT.png" alt="ubuntu_codec_and_DSDT"><br>将桌面上的codec#0和tables目录复制到LINUX以外的支持写入的盘符下,Linux下面的工作已经完成,您可以继续试用或者重启/关机.</p>
<h1 id="整理有效节点"><a href="#整理有效节点" class="headerlink" title="整理有效节点"></a>整理有效节点</h1><p>使用到的工具：<code>verbit.sh</code>,<a href="https://github.com/daliansky/dell7000/blob/master/hda-tools/verbit.sh" target="_blank" rel="external">下载链接</a><br>用法: <code>verbit.sh codec#0</code>,它会生成如下显示的信息:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">Verbs from Linux Codec Dump <span class="symbol">File:</span> codec<span class="comment">#0</span></div><div class="line"></div><div class="line"><span class="symbol">Codec:</span> Realtek ALC3246   <span class="symbol">Address:</span> <span class="number">0</span>   <span class="symbol">DevID:</span> <span class="number">283902550</span> (<span class="number">0x10ec0256</span>)</div><div class="line"></div><div class="line">   Jack   Color  Description                  Node     PinDefault             Original Verbs</div><div class="line">--------------------------------------------------------------------------------------------------------</div><div class="line">Digital Unknown  Mic at Int N/A              <span class="number">18</span> <span class="number">0x12</span>   <span class="number">0x90a60170</span>   <span class="number">01271</span>c7<span class="number">0</span> <span class="number">01271</span>d01 <span class="number">01271</span>ea6 <span class="number">01271</span>f9<span class="number">0</span></div><div class="line">Unknown Unknown  Line Out at Ext N/A         <span class="number">19</span> <span class="number">0x13</span>   <span class="number">0x40000000</span>   <span class="number">01371</span>c0<span class="number">0</span> <span class="number">01371</span>d0<span class="number">0</span> <span class="number">01371</span>e0<span class="number">0</span> <span class="number">01371</span>f4<span class="number">0</span></div><div class="line"> Analog Unknown  Speaker at Int N/A          <span class="number">20</span> <span class="number">0x14</span>   <span class="number">0x90170140</span>   <span class="number">01471</span>c4<span class="number">0</span> <span class="number">01471</span>d01 <span class="number">01471</span>e17 <span class="number">01471</span>f9<span class="number">0</span></div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  Speaker at Ext Rear         <span class="number">24</span> <span class="number">0x18</span>   <span class="number">0x411111f0</span>   <span class="number">01</span>871cf<span class="number">0</span> <span class="number">01</span>871d11 <span class="number">01</span>871e11 <span class="number">01</span>871f41</div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  Speaker at Ext Rear         <span class="number">25</span> <span class="number">0x19</span>   <span class="number">0x411111f0</span>   <span class="number">01</span>971c1<span class="number">0</span> <span class="number">01</span>971d2<span class="number">0</span> <span class="number">01</span>971e81 <span class="number">01</span>971f02</div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  Speaker at Ext Rear         <span class="number">26</span> <span class="number">0x1a</span>   <span class="number">0x411111f0</span>   <span class="number">01</span>a71cf<span class="number">0</span> <span class="number">01</span>a71d11 <span class="number">01</span>a71e11 <span class="number">01</span>a71f41</div><div class="line"> 	<span class="number">1</span>/<span class="number">8</span>   Black  Speaker at Ext Rear     	 <span class="number">27</span> <span class="number">0x1b</span>   <span class="number">0x411111f0</span>   <span class="number">01</span>b71cf<span class="number">0</span> <span class="number">01</span>b71d11 <span class="number">01</span>b71e11 <span class="number">01</span>b71f41  </div><div class="line"> Analog    Pink  Modem Hand at Ext N/A       <span class="number">29</span> <span class="number">0x1d</span>   <span class="number">0x40779a2d</span>   <span class="number">01</span>d71c2d <span class="number">01</span>d71d9a <span class="number">01</span>d71e77 <span class="number">01</span>d71f4<span class="number">0</span></div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  Speaker at Ext Rear         <span class="number">30</span> <span class="number">0x1e</span>   <span class="number">0x411111f0</span>   <span class="number">01</span>e71cf<span class="number">0</span> <span class="number">01</span>e71d11 <span class="number">01</span>e71e11 <span class="number">01</span>e71f41</div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  HP Out at Ext Front         <span class="number">33</span> <span class="number">0x21</span>   <span class="number">0x02211030</span>   <span class="number">02171</span>c3<span class="number">0</span> <span class="number">02171</span>d1<span class="number">0</span> <span class="number">02171</span>e21 <span class="number">02171</span>f02</div><div class="line">--------------------------------------------------------------------------------------------------------</div><div class="line"></div><div class="line"></div><div class="line">   Jack   Color  Description                  Node     PinDefault             Modified Verbs</div><div class="line">--------------------------------------------------------------------------------------------------------</div><div class="line">Digital Unknown  Mic at Int N/A              <span class="number">18</span> <span class="number">0x12</span>   <span class="number">0x90a60170</span>   <span class="number">01271</span>c7<span class="number">0</span> <span class="number">01271</span>d0<span class="number">0</span> <span class="number">01271</span>ea6 <span class="number">01271</span>f9<span class="number">0</span></div><div class="line">Unknown Unknown  Line Out at Ext N/A         <span class="number">19</span> <span class="number">0x13</span>   <span class="number">0x40000000</span>   <span class="number">01371</span>c0<span class="number">0</span> <span class="number">01371</span>d0<span class="number">0</span> <span class="number">01371</span>e0<span class="number">0</span> <span class="number">01371</span>f4<span class="number">0</span></div><div class="line"> Analog Unknown  Speaker at Int N/A          <span class="number">20</span> <span class="number">0x14</span>   <span class="number">0x90170120</span>   <span class="number">01471</span>c2<span class="number">0</span> <span class="number">01471</span>d0<span class="number">0</span> <span class="number">01471</span>e17 <span class="number">01471</span>f9<span class="number">0</span></div><div class="line"> Analog    Pink  Modem Hand at Ext N/A       <span class="number">29</span> <span class="number">0x1d</span>   <span class="number">0x40779a2d</span>   <span class="number">01</span>d71c4<span class="number">0</span> <span class="number">01</span>d71d9<span class="number">0</span> <span class="number">01</span>d71e77 <span class="number">01</span>d71f4<span class="number">0</span></div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  HP Out at Ext Front         <span class="number">33</span> <span class="number">0x21</span>   <span class="number">0x02211030</span>   <span class="number">02171</span>c3<span class="number">0</span> <span class="number">02171</span>d1<span class="number">0</span> <span class="number">02171</span>e21 <span class="number">02171</span>f01</div><div class="line">--------------------------------------------------------------------------------------------------------</div><div class="line"></div><div class="line">Modified Verbs <span class="keyword">in</span> One <span class="symbol">Line:</span> <span class="number">01271</span>c7<span class="number">0</span> <span class="number">01271</span>d0<span class="number">0</span> <span class="number">01271</span>ea6 <span class="number">01271</span>f9<span class="number">0</span> <span class="number">01371</span>c0<span class="number">0</span> <span class="number">01371</span>d0<span class="number">0</span> <span class="number">01371</span>e0<span class="number">0</span> <span class="number">01371</span>f4<span class="number">0</span> <span class="number">01471</span>c2<span class="number">0</span> <span class="number">01471</span>d0<span class="number">0</span> <span class="number">01471</span>e17 <span class="number">01471</span>f9<span class="number">0</span> <span class="number">01</span>d71c4<span class="number">0</span> <span class="number">01</span>d71d9<span class="number">0</span> <span class="number">01</span>d71e77 <span class="number">01</span>d71f4<span class="number">0</span> <span class="number">02171</span>c3<span class="number">0</span> <span class="number">02171</span>d1<span class="number">0</span> <span class="number">02171</span>e21 <span class="number">02171</span>f01</div><div class="line">--------------------------------------------------------------------------------------------------------</div></pre></td></tr></table></figure>
<p>如果你希望将输出结果保存下来,可以将命令改为:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">verbit.sh codec<span class="comment">#0 &gt; ALC256_dump.txt</span></div></pre></td></tr></table></figure>
<p>这个ALC256_dump.txt就是上面显示的输出信息,你可以使用其它的文字编辑器打开它.<br>重要的信息不能漏掉了,后面我们在编译声卡驱动的时候会经常用到它们:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Codec: Realtek ALC3246   Address: 0   DevID: 283902550 (0x10ec0256)</div></pre></td></tr></table></figure>
<p>其中的:</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>Codec: Realtek ALC3246</td>
<td>是告诉了你的声卡型号是ALC3246(ALC256)</td>
</tr>
<tr>
<td>Address: 0</td>
<td>会告诉你生成configdata的数据的前缀是0,比如上面显示输出信息最后一行的<code>Modified Verbs in One Line:</code>后面所有的数据中,每组数据的第一位就是这个 <code>0</code> ,如果<code>Address: 2</code>,那么每组数据的第一位就是 <code>2</code> ,这个后面我们会用到它</td>
</tr>
<tr>
<td>DevID: 283902550 (0x10ec0256)</td>
<td>283902550是0x10ec0256的10进制值,0x10ec 是指vendorID(芯片供应商ID),是REALTEK的设备标识,0256是指型号,去掉前面的0,您的声卡型号就是:ALC256</td>
</tr>
</tbody>
</table>
<p>过去的教程会告诉你,通过运行<code>verbit.sh</code>整理出来的节点是:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">18 0x12 Mic at Int</div><div class="line">20 0x14 Speaker at Int</div><div class="line">33 0x21 HP Out at Ext Front</div></pre></td></tr></table></figure>
<p>至于上面输出信息里显示的0x13 0x1d都是无效的节点.而且它只有三个有效的节点,我的声卡ALC256是用于笔记本,按理说它至少还应该存在另一个Mic Ext的节点,我需要找出它来.看来使用传统的方法已经无法满足我的求知欲了.<br>既然使用Linux可以提取codec,那么有没有可能 </p>
<h1 id="通过Linux找出有效的节点"><a href="#通过Linux找出有效的节点" class="headerlink" title="通过Linux找出有效的节点"></a><em>通过Linux找出有效的节点</em></h1><p>呢?<br>为了测试我的声卡存在第四个节点,我需要找出耳机的Mic输入节点,于是乎重新引导进入Linux,插上耳机,它弹出了这个窗口:<br><img src="http://ous2s14vo.bkt.clouddn.com/SelectAudioDevice.png" alt="SelectAudioDevice"><br>这三个选项的意思是让我选择声音设备,既然我希望找出耳机麦克风的输入,我就选择了中间带有耳麦的图标<br>进入<code>Sound Settings</code>,点击 <code>Input</code>,选择<code>Headset Microphone</code>,调节<code>Input volume</code>,对着耳麦说话,发现有输入电平了,再切换到内置麦克风<code>Internal Microphone</code>,也有输入电平,那么至少说明我的声卡功能是完整的,至少在Linux下它工作的很好.<br><img src="http://ous2s14vo.bkt.clouddn.com/SoundInputDeviceSelect.png" alt="SoundInputDeviceSelect"><br>测试结果已经出来了,我想要知道耳麦的有效节点是什么,使用组合键<code>CTRL+ALT+t</code>打开终端,输入命令:<code>dmesg</code>看看它会有什么变化,结果我就看到了下面的文字:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[    5.040591] snd_hda_codec_realtek hdaudioC0D0: autoconfig <span class="keyword">for</span> ALC3246: line_outs=1 (0x14/0x0/0x0/0x0/0x0) <span class="built_in">type</span>:speaker</div><div class="line">[    5.040593] snd_hda_codec_realtek hdaudioC0D0:    speaker_outs=0 (0x0/0x0/0x0/0x0/0x0)</div><div class="line">[    5.040595] snd_hda_codec_realtek hdaudioC0D0:    hp_outs=1 (0x21/0x0/0x0/0x0/0x0)</div><div class="line">[    5.040595] snd_hda_codec_realtek hdaudioC0D0:    mono: mono_out=0x0</div><div class="line">[    5.040596] snd_hda_codec_realtek hdaudioC0D0:    inputs:</div><div class="line">[    5.040598] snd_hda_codec_realtek hdaudioC0D0:      Headset Mic=0x19</div><div class="line">[    5.040599] snd_hda_codec_realtek hdaudioC0D0:      Headphone Mic=0x1a</div><div class="line">[    5.040600] snd_hda_codec_realtek hdaudioC0D0:      Internal Mic=0x12</div></pre></td></tr></table></figure>
<p>我不想看到其它的输出信息,我只需要得到我想要的信息,于是将命令改为:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sky@sky-Inspiron-7560:~$ dmesg | grep snd_hda_codec_realtek</div><div class="line">[    5.040591] snd_hda_codec_realtek hdaudioC0D0: autoconfig <span class="keyword">for</span> ALC3246: line_outs=1 (0x14/0x0/0x0/0x0/0x0) <span class="built_in">type</span>:speaker</div><div class="line">[    5.040593] snd_hda_codec_realtek hdaudioC0D0:    speaker_outs=0 (0x0/0x0/0x0/0x0/0x0)</div><div class="line">[    5.040595] snd_hda_codec_realtek hdaudioC0D0:    hp_outs=1 (0x21/0x0/0x0/0x0/0x0)</div><div class="line">[    5.040595] snd_hda_codec_realtek hdaudioC0D0:    mono: mono_out=0x0</div><div class="line">[    5.040596] snd_hda_codec_realtek hdaudioC0D0:    inputs:</div><div class="line">[    5.040598] snd_hda_codec_realtek hdaudioC0D0:      Headset Mic=0x19</div><div class="line">[    5.040599] snd_hda_codec_realtek hdaudioC0D0:      Headphone Mic=0x1a</div><div class="line">[    5.040600] snd_hda_codec_realtek hdaudioC0D0:      Internal Mic=0x12</div></pre></td></tr></table></figure>
<p>得到的输出结果跟上面的相同,于是我发现了在Linux下我的声卡的有效节点分别为:</p>
<ul>
<li>0x14 Speaker out</li>
<li>0x21 HP out </li>
<li>0x19 Headset Mic in</li>
<li>0x1a Headphone Mic in</li>
<li>0x12 Internal Mic in</li>
</ul>
<p>暂且不讨论我的声卡是几节点,我发现通过linux完全可以得出声卡的有效节点,而且这种方式好像也不需要使用什么专用的工具,只是在linux下面通过内部命令<code>dmesg</code>无意中就被我发现了声卡中最挠头的找有效节点的打怪秘籍,这种方法在整个Hackintosh社区里还没见有人用过.看来这跟我之前使用linux经常会通过<code>dmesg</code>排错的使用习惯是分不开的,这里要由衷地给自己点一个大大的</p>
<h1 id="赞"><a href="#赞" class="headerlink" title="赞"></a>赞</h1><p>在这个特别的日子里<code>11.11</code>,没有陪女朋友的小伙伴们,都可以使用我刚get到的新技能愉快地打怪升级啦!</p>
<p>暂更于此,做个记号 2017年11月11日</p>
<hr>
<p>继续更新</p>
<p>先将节点整理成一个表格,这个表格里会包括之前整理出的数据</p>
<table>
<thead>
<tr>
<th>有效节点</th>
<th>10进制</th>
<th>设备名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x14</td>
<td>20</td>
<td>Speaker out</td>
</tr>
<tr>
<td>0x21</td>
<td>21</td>
<td>HP out </td>
</tr>
<tr>
<td>0x19</td>
<td>25</td>
<td>Headset Mic in</td>
</tr>
<tr>
<td>0x1a</td>
<td>26</td>
<td>Headphone Mic in</td>
</tr>
<tr>
<td>0x12</td>
<td>18</td>
<td>Internal Mic in</td>
</tr>
</tbody>
</table>
<p>之所以加上转换后的10进制,就是为了以后制作pathmap做准备</p>
<h1 id="整理有效路径"><a href="#整理有效路径" class="headerlink" title="整理有效路径"></a>整理有效路径</h1><p>使用codecgraph生成pathmap图<br>命令如下:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ codecgraph codec\<span class="comment">#0</span></div><div class="line">Codec: Realtek ALC3246</div><div class="line">Generating codec<span class="comment">#0.svg</span></div></pre></td></tr></table></figure>
<p>如果出现<code>error: dot executable not found (did you install graphviz?)</code>的错误提示的话,那么还需要执行下面的动作,打开终端,输入命令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span> <span class="comment"># 安装brew</span></div></pre></td></tr></table></figure>
<p>安装<code>brew</code>的过程中会提醒你安装<code>Xcode Command Tools</code>,请选择<code>yes</code>.<br>安装完<code>brew</code>之后,继续执行:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install graphviz   <span class="comment"># 安装codecgraph所需要的依赖程序</span></div></pre></td></tr></table></figure>
<p>这个生成的codec#0.svg就是声卡的pathmap,使用<code>Sketch.app</code>打开它<br><img src="http://ous2s14vo.bkt.clouddn.com/codec.png" alt="codec"><br>是不是看了头老大?没错,我刚开始看的时候也是一头的雾水,看多了后就会总结出经验来<br>还记得我们在前面整理出的有效节点吧?!<br>还是以我的声卡为例,上文中我已经整理出5个节点,按照顺序来:<br>    0x14,这个是Speaker的节点,也就是喇叭,我们也俗称为外放,如果想让它正确地发声,就需要看看跟它连接的节点都有哪些,在图片里找到0x14位于图片的最下方,我把它放大下:<br>    <img src="http://ous2s14vo.bkt.clouddn.com/node_output.png" alt="node_output"><br>通过观察我们会发现,0x14与0x02连接,转换成10进制就是20-&gt;2,同样的,0x21与0x03连接,转换成10进制就是33-&gt;3,我们把它放到表格中</p>
<table>
<thead>
<tr>
<th>有效节点</th>
<th>10进制</th>
<th>设备名称</th>
<th>路径</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x14</td>
<td>20</td>
<td>Speaker out</td>
<td><strong>20-&gt;2</strong></td>
</tr>
<tr>
<td>0x21</td>
<td>33</td>
<td>HP out</td>
<td><strong>33-&gt;3</strong></td>
</tr>
<tr>
<td>0x19</td>
<td>25</td>
<td>Headset Mic in</td>
</tr>
<tr>
<td>0x1a</td>
<td>26</td>
<td>Headphone Mic in</td>
</tr>
<tr>
<td>0x12</td>
<td>18</td>
<td>Internal Mic in</td>
</tr>
</tbody>
</table>
<p>怎么样?也没想像的那么复杂吧?两个输出设备的节点和路径已经整理出来,下一步,我们要把输入设备和节点整理出来<br><img src="http://ous2s14vo.bkt.clouddn.com/node_input.png" alt="node_input"><br>再来看图片的上半部,最右侧的0x08和0x09是两个声音输入的节点,0x23和0x22是两个混音设备,最前方是设备节点,这个就是输入设备的路径.<br>我的声卡的0x12声音输入路径包括了3个节点;为了便于理解,被我圈起来的红线部分就是0x12(Mic in)的路径(pathmap),8-&gt;35-&gt;18就是路径,照样还是要将数据放到表格里<br><img src="http://ous2s14vo.bkt.clouddn.com/node12_pathmap.png" alt="node12_pathmap"></p>
<table>
<thead>
<tr>
<th>有效节点</th>
<th>10进制</th>
<th>设备名称</th>
<th>路径</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x14</td>
<td>20</td>
<td>Speaker out</td>
<td><strong>20-&gt;2</strong></td>
</tr>
<tr>
<td>0x21</td>
<td>33</td>
<td>HP out</td>
<td><strong>33-&gt;3</strong></td>
</tr>
<tr>
<td>0x19</td>
<td>25</td>
<td>Headset Mic in</td>
<td></td>
</tr>
<tr>
<td>0x1a</td>
<td>26</td>
<td>Headphone Mic in</td>
<td></td>
</tr>
<tr>
<td>0x12</td>
<td>18</td>
<td>Internal Mic in</td>
<td><strong>8-&gt;35-&gt;18</strong></td>
</tr>
</tbody>
</table>
<p>还记得文章前面通过linux找出来的有效节点不?我的耳麦可是支持输入的,节点也找出来了,是0x19(Headset Mic in),我需要将路径找出来,我发现0x19同时连接了两个节点:0x23和0x22,相应地路径为:8-&gt;35-&gt;25和9-&gt;34-&gt;25,顺手也把0x1a的路径也整理出来备用,将这两组数据补充进表格里</p>
<table>
<thead>
<tr>
<th>有效节点</th>
<th>10进制</th>
<th>设备名称</th>
<th>路径</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x14</td>
<td>20</td>
<td>Speaker out</td>
<td><strong>20-&gt;2</strong></td>
</tr>
<tr>
<td>0x21</td>
<td>33</td>
<td>HP out</td>
<td><strong>33-&gt;3</strong></td>
</tr>
<tr>
<td>0x19</td>
<td>25</td>
<td>Headset Mic in</td>
<td><strong>8-&gt;35-&gt;25</strong> <strong>9-&gt;34-&gt;25</strong></td>
</tr>
<tr>
<td>0x1a</td>
<td>26</td>
<td>Headphone Mic in</td>
<td><strong>8-&gt;35-&gt;26</strong> <strong>9-&gt;34-&gt;26</strong></td>
</tr>
<tr>
<td>0x12</td>
<td>18</td>
<td>Internal Mic in</td>
<td><strong>8-&gt;35-&gt;18</strong></td>
</tr>
</tbody>
</table>
<p>至于0x1a是否有效暂且放到一边,一个包括了有效节点/设备名称/路径的表格就整理完成了,这里<strong><em>需要强调的一点是:路径数值使用10进制</em></strong></p>
<h1 id="整理ConfigData"><a href="#整理ConfigData" class="headerlink" title="整理ConfigData"></a>整理ConfigData</h1><blockquote>
<p><code>ConfigData</code>的获得有两种方法:这两种方法分别为:通过<code>codec</code>里面的<code>Pin Default</code>提取以及通过<code>PinConfigs</code>提取,然后修正<code>ConfigData</code>.下面我们将分别介绍这两种提取方法</p>
</blockquote>
<h2 id="通过PinConfigs提取ConfigData"><a href="#通过PinConfigs提取ConfigData" class="headerlink" title="通过PinConfigs提取ConfigData"></a>通过PinConfigs提取ConfigData</h2><p>ConfigData数据位于<code>PinConfigs.kext/Contents/Info.plist</code>里,<code>PinConfigs.kext</code>作为<code>AppleALC</code>插件被加载.<br>用到的工具:<code>Plist Editor Pro.app</code><br>还是以我的ALC256为例:打开<code>Info.plist</code>后,使用组合快捷键<code>⌘+f</code>打开搜索: <code>ALC256</code> 或者 <code>283902550</code> ,它会直接定位到你需要查找的数据位置,再按<code>⌘+g</code>,将相同的字符串全部搜索完毕,直到它又跳转到第一个搜索结果的位置,结果如下图:<br><img src="http://ous2s14vo.bkt.clouddn.com/PlistEditorPro.png" alt="PlistEditorPro"><br>ALC256的ConfigData的数据有三组,分别对应的LayoutID为:13 28 56<br>将这三组ConfigData复制出来:</p>
<p>id:13<br><code>01271C10 01271D00 01271EA6 01271F90 01471C20 01471D00 01471E17 01471F90 01971C30 01971D10 01971E8B 01971F02 02171C50 02171D10 02171E2B 02171F02 01470c02</code></p>
<p>id:28<br><code>01471C50 01471D00 01471E17 01471F90 01470c02 01A71C30 01A71D00 01A71EA0 01A71F90 02171C20 02171D10 02171E21 02171F00</code></p>
<p>id:56<br><code>01271C10 01271D00 01271EA6 01271F90 01471C20 01471D00 01471E17 01471F90 01971C30 01971D10 01971E8B 01971F02 01A71C40 01A71D10 01A71E81 01A71F02 01D71CF0 01D71D11 01D71E11 01D71F41 02171C50 02171D10 02171E2B 02171F02 01470c02 02170c02</code></p>
<p>这么看起来是杂乱无章的,我们将它格式化一下,每个节点一行,四组数据:<br>id:13 </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">01271C10 01271D00 01271EA6 01271F90 </div><div class="line">01471C20 01471D00 01471E17 01471F90 </div><div class="line">01971C30 01971D10 01971E8B 01971F02 </div><div class="line">02171C50 02171D10 02171E2B 02171F02 01470c02</div></pre></td></tr></table></figure>
<p>id:28 </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">01471C50 01471D00 01471E17 01471F90 01470c02 </div><div class="line">01A71C30 01A71D00 01A71EA0 01A71F90 </div><div class="line">02171C20 02171D10 02171E21 02171F00</div></pre></td></tr></table></figure>
<p>id:56 </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">01271C10 01271D00 01271EA6 01271F90 </div><div class="line">01471C20 01471D00 01471E17 01471F90 01470c02 </div><div class="line">01971C30 01971D10 01971E8B 01971F02 </div><div class="line">01A71C40 01A71D10 01A71E81 01A71F02 </div><div class="line">01D71CF0 01D71D11 01D71E11 01D71F41 </div><div class="line">02171C50 02171D10 02171E2B 02171F02 02170c02</div></pre></td></tr></table></figure>
<p>从中我们可以发现:<br>id:13为四行四节点,节点为:<code>0x12 0x14 0x19 0x21</code><br>id:28为三行三节点,节点为:<code>0x14 0x1A 0x21</code><br>id:56为六行六节点,节点为:<code>0x12 0x14 0x19 0x1A 0x1D 0x21</code><br>现在有个问题摆在你们的面前,我上面明明刚说过每个节点为四组数据,那为什么在0x14和0x21的节点后面又多出来一组数据呢?这组数据又有什么作用呢?原来秘密都藏在<code>codec</code>里面,它定义了某些输出设备具有<code>EAPD</code>,比如0x14节点的数据:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Node <span class="number">0x14</span> [Pin Complex] wcaps <span class="number">0x40058d</span>: Stereo Amp-Out</div><div class="line">  <span class="symbol">Control:</span> name=<span class="string">"Speaker Playback Switch"</span>, index=<span class="number">0</span>, device=<span class="number">0</span></div><div class="line">    <span class="symbol">ControlAmp:</span> chs=<span class="number">3</span>, dir=Out, idx=<span class="number">0</span>, ofs=<span class="number">0</span></div><div class="line">  Amp-Out <span class="symbol">caps:</span> ofs=<span class="number">0x00</span>, nsteps=<span class="number">0x00</span>, stepsize=<span class="number">0x00</span>, mute=<span class="number">1</span></div><div class="line">  Amp-Out <span class="symbol">vals:</span>  [<span class="number">0x00</span> <span class="number">0x00</span>]</div><div class="line">  Pincap <span class="number">0x00010014</span>: OUT EAPD Detect</div><div class="line">  EAPD <span class="number">0x2</span>: EAPD</div><div class="line">  Pin Default <span class="number">0x90170120</span>: [Fixed] Speaker at Int N/A</div><div class="line">    Conn = Analog, Color = Unknown</div><div class="line">    DefAssociation = <span class="number">0x2</span>, Sequence = <span class="number">0x0</span></div><div class="line">    Misc = NO_PRESENCE</div><div class="line">  Pin-<span class="symbol">ctls:</span> <span class="number">0x40</span>: OUT</div><div class="line">  <span class="symbol">Unsolicited:</span> tag=<span class="number">00</span>, enabled=<span class="number">0</span></div><div class="line">  Power <span class="symbol">states:</span>  D<span class="number">0</span> D1 D2 D3 EPSS</div><div class="line">  <span class="symbol">Power:</span> setting=D<span class="number">0</span>, actual=D<span class="number">0</span></div><div class="line">  <span class="symbol">Connection:</span> <span class="number">1</span></div><div class="line">     <span class="number">0x02</span></div></pre></td></tr></table></figure>
<p>具有<code>EAPD</code>的节点需要添加参数<code>SET_EAPD_BTLENABLE</code>,转换成数值为<code>0x70c</code>,完整的数值为:<code>Address</code>+<code>节点</code>+<code>70c</code>+<code>02</code>,即:<code>01470c02</code>,它通过<code>hda-verb</code>可以执行,比如<code>CodecCommander</code>就是调用的<code>hda-verb</code>执行的命令.更多的<code>hda-verb</code>参数请参考我之前的文章:<a href="https://blog.daliansky.net/hda-verb-parameter-detail-table.html">hda-verb参数详表</a><br>这里我教大家一个简单判断<code>EAPD</code>节点的方法:那就是它通常会位于<code>Speaker Out</code>和<code>HP Out</code>这两个输出节点上.至于其它教程提到过的<strong>关于<code>01470c02</code>是组神奇的代码,可以让外放发声</strong>的说法是错误的,它可能刚好声卡的<code>Speaker Out</code>的输出节点是<code>0x14</code>而已.如果您的<code>Speaker Out</code>输出节点是<code>0x16</code>,那么就需要把它修改为<code>01670c02</code>,当然要遵守这个公式:<code>Address</code>+<code>节点</code>+<code>71c</code>+<code>02</code></p>
<p>本节教程先更新到这里 11-13-2017 10:25PM</p>
<p>续更</p>
<p>另外一种找出<code>EAPD</code>节点的方法:使用工具<code>node_dump.sh</code>,它会显示出每个节点的信息,包括<code>EAPD</code>输出,详细的用法以后再补充上.</p>
<p>说了半天,也只说了一个<code>01470c02</code>是干什么用的,其它的四组数据都分别代表什么呢?这个话题如果展开讲的话,没个一两天是说不明白的.<br>接下来的部分就会介绍到这四组数据是怎么整理出来的.</p>
<h2 id="通过codec里面的Pin-Default提取并整理"><a href="#通过codec里面的Pin-Default提取并整理" class="headerlink" title="通过codec里面的Pin Default提取并整理"></a>通过<code>codec</code>里面的<code>Pin Default</code>提取并整理</h2><p>将使用<code>verbit.sh</code>整理出来的<code>ALC256_dump.txt</code>重新打开:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Verbs from Linux Codec Dump <span class="symbol">File:</span> codec<span class="comment">#0</span></div><div class="line"></div><div class="line"><span class="symbol">Codec:</span> Realtek ALC3246   <span class="symbol">Address:</span> <span class="number">0</span>   <span class="symbol">DevID:</span> <span class="number">283902550</span> (<span class="number">0x10ec0256</span>)</div><div class="line"></div><div class="line">   Jack   Color  Description                  Node     PinDefault             Original Verbs</div><div class="line">--------------------------------------------------------------------------------------------------------</div><div class="line">Digital Unknown  Mic at Int N/A              <span class="number">18</span> <span class="number">0x12</span>   <span class="number">0x90a60170</span>   <span class="number">01271</span>c7<span class="number">0</span> <span class="number">01271</span>d01 <span class="number">01271</span>ea6 <span class="number">01271</span>f9<span class="number">0</span></div><div class="line">Unknown Unknown  Line Out at Ext N/A         <span class="number">19</span> <span class="number">0x13</span>   <span class="number">0x40000000</span>   <span class="number">01371</span>c0<span class="number">0</span> <span class="number">01371</span>d0<span class="number">0</span> <span class="number">01371</span>e0<span class="number">0</span> <span class="number">01371</span>f4<span class="number">0</span></div><div class="line"> Analog Unknown  Speaker at Int N/A          <span class="number">20</span> <span class="number">0x14</span>   <span class="number">0x90170140</span>   <span class="number">01471</span>c4<span class="number">0</span> <span class="number">01471</span>d01 <span class="number">01471</span>e17 <span class="number">01471</span>f9<span class="number">0</span></div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  Speaker at Ext Rear         <span class="number">24</span> <span class="number">0x18</span>   <span class="number">0x411111f0</span>   <span class="number">01</span>871cf<span class="number">0</span> <span class="number">01</span>871d11 <span class="number">01</span>871e11 <span class="number">01</span>871f41</div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  Speaker at Ext Rear         <span class="number">25</span> <span class="number">0x19</span>   <span class="number">0x411111f0</span>   <span class="number">01</span>971c1<span class="number">0</span> <span class="number">01</span>971d2<span class="number">0</span> <span class="number">01</span>971e81 <span class="number">01</span>971f02</div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  Speaker at Ext Rear         <span class="number">26</span> <span class="number">0x1a</span>   <span class="number">0x411111f0</span>   <span class="number">01</span>a71cf<span class="number">0</span> <span class="number">01</span>a71d11 <span class="number">01</span>a71e11 <span class="number">01</span>a71f41</div><div class="line"> 	<span class="number">1</span>/<span class="number">8</span>   Black  Speaker at Ext Rear     	 <span class="number">27</span> <span class="number">0x1b</span>   <span class="number">0x411111f0</span>   <span class="number">01</span>b71cf<span class="number">0</span> <span class="number">01</span>b71d11 <span class="number">01</span>b71e11 <span class="number">01</span>b71f41  </div><div class="line"> Analog    Pink  Modem Hand at Ext N/A       <span class="number">29</span> <span class="number">0x1d</span>   <span class="number">0x40779a2d</span>   <span class="number">01</span>d71c2d <span class="number">01</span>d71d9a <span class="number">01</span>d71e77 <span class="number">01</span>d71f4<span class="number">0</span></div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  Speaker at Ext Rear         <span class="number">30</span> <span class="number">0x1e</span>   <span class="number">0x411111f0</span>   <span class="number">01</span>e71cf<span class="number">0</span> <span class="number">01</span>e71d11 <span class="number">01</span>e71e11 <span class="number">01</span>e71f41</div><div class="line">    <span class="number">1</span>/<span class="number">8</span>   Black  HP Out at Ext Front         <span class="number">33</span> <span class="number">0x21</span>   <span class="number">0x02211030</span>   <span class="number">02171</span>c3<span class="number">0</span> <span class="number">02171</span>d1<span class="number">0</span> <span class="number">02171</span>e21 <span class="number">02171</span>f02</div><div class="line">--------------------------------------------------------------------------------------------------------</div></pre></td></tr></table></figure>
<p>将数据整理成如下的样式:</p>
<ul>
<li>[Fixed]是内部设备</li>
<li>[Jack]是通过插孔进行连接的外部设备</li>
<li>[N/A]是其它未知设备</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Node	PinDefault		Description </div><div class="line">----------------------------------------------------------</div><div class="line"><span class="number">0x12</span>	<span class="number">0x90a60170</span>		[Fixed]	Mic at Int       </div><div class="line"><span class="number">0x13</span>	<span class="number">0x40000000</span>		[N/A]	Line Out at Ext N/A  </div><div class="line"><span class="number">0x14</span>	<span class="number">0x90170140</span>		[Fixed]	Speaker at Int   </div><div class="line"><span class="number">0x18</span>	<span class="number">0x411111f0</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">0x19</span>	<span class="number">0x411111f0</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">0x1a</span>	<span class="number">0x411111f0</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">0x1b</span>	<span class="number">0x411111f0</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">0x1d</span>	<span class="number">0x40779a2d</span>		[N/A]	Modem Hand at Ext N/A</div><div class="line"><span class="number">0x1e</span>	<span class="number">0x411111f0</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">0x21</span>	<span class="number">0x02211030</span>		[Jack]	HP Out at Ext Front  </div><div class="line">----------------------------------------------------------</div></pre></td></tr></table></figure>
<p>将<code>PinDefault</code>进行小端转换<a href="https://zh.wikipedia.org/zh-hans/字节序" target="_blank" rel="external">little-endian</a>,这里借用一张紫米教程里面的图片进行小端转换的理解:<br><img src="http://ous2s14vo.bkt.clouddn.com/little-endian.jpg" alt="little-endian"><br>就是把<code>PinDefault</code>的数据两两对调,比如:<code>0x12</code>节点的<code>[Fixed]    Mic at Int</code>原始数据为:<code>0x90a60170</code>,去掉前面的<code>0x</code>,变成<code>90 a6 01 70</code>,<br>最前面的<code>90</code>跑到了最后,最后的<code>70</code>又跑到了最前面,中间的<code>a6</code>和<code>01</code>再对调下,就变成了<code>70 01 a6 90</code>.整理后,变成如下的格式:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Node            c  d  e  f              Description</div><div class="line"><span class="number">12</span>		<span class="number">70</span> <span class="number">01</span> a6 <span class="number">90</span>		[Fixed]	Mic at Int       </div><div class="line"><span class="number">13</span>		<span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">40</span>		[N/A]	Line Out at Ext N/A  </div><div class="line"><span class="number">14</span>		<span class="number">40</span> <span class="number">01</span> <span class="number">17</span> <span class="number">90</span>		[Fixed]	Speaker at Int   </div><div class="line"><span class="number">18</span>		f<span class="number">0</span> <span class="number">11</span> <span class="number">11</span> <span class="number">41</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">19</span>		f<span class="number">0</span> <span class="number">11</span> <span class="number">11</span> <span class="number">41</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">1</span>a		f<span class="number">0</span> <span class="number">11</span> <span class="number">11</span> <span class="number">41</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">1</span>b		f<span class="number">0</span> <span class="number">11</span> <span class="number">11</span> <span class="number">41</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">1</span>d		<span class="number">2</span>d <span class="number">9</span>a <span class="number">77</span> <span class="number">40</span>		[N/A]	Modem Hand at Ext N/A</div><div class="line"><span class="number">1</span>e		f<span class="number">0</span> <span class="number">11</span> <span class="number">11</span> <span class="number">41</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">21</span>		<span class="number">30</span> <span class="number">10</span> <span class="number">21</span> <span class="number">02</span>		[Jack]	HP Out at Ext Front</div></pre></td></tr></table></figure>
<p>下一步,我们要对数据进行修正,让它看起来更像<code>APPLE</code>.</p>
<h2 id="修正PinDefault-并生成ConfigData"><a href="#修正PinDefault-并生成ConfigData" class="headerlink" title="修正PinDefault,并生成ConfigData"></a>修正<code>PinDefault</code>,并生成<code>ConfigData</code></h2><p>上一节我们只是把数据进一步地整理出来,并进行了格式化,我们并没有对数据进行修正.本节我们就开始进行<code>PinDefault</code>的修正,先上一张我整理出来的表格:<br><img src="http://ous2s14vo.bkt.clouddn.com/pinconfigs.png" alt="pinconfigs"></p>
<ul>
<li>前面我提到过通过Linux找到的节点<code>0x19</code>,它在Linux下面显示的设备为<code>Headset Mic</code>,在上一节中我们整理出的<code>0x19</code>的设备为:<code>[N/A]    Speaker at Ext Rear</code> , <code>PinDefault</code>值为:<code>f0 11 11 41</code>,通过上表我们得知,这个端口是被屏蔽掉的,就是不起作用的节点.</li>
<li>现在我们希望它能正常工作,我的想法是把它修正为:<code>[Jack] Mic at Ext</code>,一个可以正常工作的外部麦克输入设备,结合上面的表格,我将<code>f0 11 11 41</code>修改为:<code>70 20 a1 02</code>.</li>
<li>由于我的耳机插孔只有一个,也就是俗称的二合一插孔,我希望在上面的外麦克工作不正常的情况下,可以将耳麦和耳机输出定义成组合插孔(2in1),上表中<code>Connection Type</code>的连接类型中,正好有个<code>B=Combination</code>,它的意思就是:<code>组合</code>,我需要同时修正耳麦和耳机的数值:<ul>
<li><code>Mic at Ext</code> : <code>f0 11 11 41</code>-&gt;<code>70 20 ab 02</code></li>
<li><code>HP Out Ext</code> : <code>30 10 21 02</code>-&gt;<code>30 10 2b 02</code></li>
</ul>
</li>
</ul>
<p>更新于:11-15-2017 16:41</p>
<p>继续更新<br><code>0x1d</code>的节点为无效节点,所以必须把它屏蔽起来,为了让它更符合<code>APPLE</code>的规范,我们使用<code>f0 00 00 40</code>来屏蔽,包括其它的不用的节点.修正后的数据为:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Node            c  d  e  f              Description</div><div class="line"><span class="number">12</span>		<span class="number">70</span> <span class="number">01</span> a6 <span class="number">90</span>		[Fixed]	Mic at Int       </div><div class="line"><span class="number">13</span>		f<span class="number">0</span> <span class="number">00</span> <span class="number">00</span> <span class="number">40</span>		[N/A]	Line Out at Ext N/A  </div><div class="line"><span class="number">14</span>		<span class="number">40</span> <span class="number">01</span> <span class="number">17</span> <span class="number">90</span>		[Fixed]	Speaker at Int   </div><div class="line"><span class="number">18</span>		f<span class="number">0</span> <span class="number">00</span> <span class="number">00</span> <span class="number">40</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">19</span>		<span class="number">70</span> <span class="number">10</span> ab <span class="number">02</span>		[Jack]	Mic at Ext  </div><div class="line"><span class="number">1</span>a		f<span class="number">0</span> <span class="number">00</span> <span class="number">00</span> <span class="number">40</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">1</span>b		f<span class="number">0</span> <span class="number">00</span> <span class="number">00</span> <span class="number">40</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">1</span>d		f<span class="number">0</span> <span class="number">00</span> <span class="number">00</span> <span class="number">40</span>		[N/A]	Modem Hand at Ext N/A</div><div class="line"><span class="number">1</span>e		f<span class="number">0</span> <span class="number">00</span> <span class="number">00</span> <span class="number">40</span>		[N/A]	Speaker at Ext Rear  </div><div class="line"><span class="number">21</span>		<span class="number">30</span> <span class="number">10</span> <span class="number">2</span>b <span class="number">02</span>		[Jack]	HP Out at Ext Front</div></pre></td></tr></table></figure>
<p>现在, 我们可以生成最终的<code>ConfigData</code>了,<br><code>ConfigData</code>的计算公式为:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Final Config:</div><div class="line">Address + Node + 71c +【c】</div><div class="line">Address + Node + 71d +【d】</div><div class="line">Address + Node + 71e +【e】</div><div class="line">Address + Node + 71f +【f】</div></pre></td></tr></table></figure>
<p>这里的<code>c</code> <code>d</code> <code>e</code> <code>f</code>就是上面整理出来的2位数值<br>我的ALC256的<code>Address</code>值为0,现在我将节点<code>0x12</code>的<code>ConfigData</code>值通过上面的公式整理后得出:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">01271c70 01271d01 01271ea6 01271f90</div></pre></td></tr></table></figure>
<p>相应地,其它的节点整理出来的数据如下:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">01271c70 01271d01 01271ea6 01271f90</div><div class="line">01371cf0 01371d00 01371e00 01371f40</div><div class="line">01471c40 01471d01 01471e17 01471f90 01470c02</div><div class="line">01871cf0 01871d00 01871e00 01871f40</div><div class="line">01971c70 01971d10 01971eab 01971f02</div><div class="line">01a71cf0 01a71d00 01a71e00 01a71f40</div><div class="line">01b71cf0 01b71d00 01b71e00 01b71f40</div><div class="line">01d71cf0 01d71d00 01d71e00 01d71f40</div><div class="line">01e71cf0 01e71d00 01e71e00 01e71f40</div><div class="line">02171c30 02171d10 02171e2b 02171f02 02170c02</div></pre></td></tr></table></figure>
<p>我将编辑的过程做了段视频,方便大家理解.</p>
<video width="640" height="480" controls><br><source src="http://ous2s14vo.bkt.clouddn.com/ConfigData.mp4"><br></video>

<p>打开<code>Sublime Text.app</code>,按住鼠标中键打开块复制,将<code>c</code> <code>d</code> <code>e</code> <code>f</code>下面的数据块拷贝一份到最下面空白处,在第一列按鼠标中键一下拉到下面,输入<code>Address</code>值<code>0</code>,再把上方的<code>Node</code>下面的数据做块复制,粘贴到0后面,再输入:<code>71c</code>,再将<code>01271</code>做块复制到后面,再分别输入<code>d</code> <code>e</code> <code>f</code>即可.最后在<code>0x14</code>和<code>0x21</code>节点后面添加两组<code>EAPD</code>数据.<br>将上面整理出来的数据去掉每行的硬回车后得到的一组数据就是最终的<code>ConfigData</code></p>
<p><code>01271c70 01271d01 01271ea6 01271f90 01371cf0 01371d00 01371e00 01371f40 01471c40 01471d01 01471e17 01471f90 01470c02 01871cf0 01871d00 01871e00 01871f40 01971c70 01971d10 01971eab 01971f02 01a71cf0 01a71d00 01a71e00 01a71f40 01b71cf0 01b71d00 01b71e00 01b71f40 01d71cf0 01d71d00 01d71e00 01d71f40 01e71cf0 01e71d00 01e71e00 01e71f40 02171c30 02171d10 02171e2b 02171f02 02170c02</code><br>到这里,<code>ConfigData</code>的数据就算整理完了.</p>
<h1 id="找出适合你的id"><a href="#找出适合你的id" class="headerlink" title="找出适合你的id"></a>找出适合你的id</h1><p>这一节里,我们就来一起动手找出最适合你的注入id<br>正确的注入id可以保证您的声卡各项功能都能正常使用,它至关重要,这里给出的方法也是为了进一步验证前面我们所做的工作.<br>到找注入id这一步,您至少已经有了这些数据:</p>
<ul>
<li>声卡基础资料:</li>
</ul>
<table>
<thead>
<tr>
<th>名称</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>Codec: Realtek ALC3246</td>
<td>是告诉了你的声卡型号是ALC3246(ALC256)</td>
</tr>
<tr>
<td>Address: 0</td>
<td>会告诉你生成configdata的数据的前缀是0,比如上面显示输出信息最后一行的<code>Modified Verbs in One Line:</code>后面所有的数据中,每组数据的第一位就是这个 <code>0</code> ,如果<code>Address: 2</code>,那么每组数据的第一位就是 <code>2</code> ,这个后面我们会用到它</td>
</tr>
<tr>
<td>DevID: 283902550 (0x10ec0256)</td>
<td>283902550是0x10ec0256的10进制值,0x10ec 是指vendorID(芯片供应商ID),是REALTEK的设备标识,0256是指型号,去掉前面的0,您的声卡型号就是:ALC256</td>
</tr>
</tbody>
</table>
<ul>
<li>整理出来的有效节点及路径</li>
</ul>
<table>
<thead>
<tr>
<th>有效节点</th>
<th>10进制</th>
<th>设备名称</th>
<th>路径</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x14</td>
<td>20</td>
<td>Speaker out</td>
<td><strong>20-&gt;2</strong></td>
</tr>
<tr>
<td>0x21</td>
<td>33</td>
<td>HP out</td>
<td><strong>33-&gt;3</strong></td>
</tr>
<tr>
<td>0x19</td>
<td>25</td>
<td>Headset Mic in</td>
<td><strong>8-&gt;35-&gt;25</strong> <strong>9-&gt;34-&gt;25</strong></td>
</tr>
<tr>
<td>0x1a</td>
<td>26</td>
<td>Headphone Mic in</td>
<td><strong>8-&gt;35-&gt;26</strong> <strong>9-&gt;34-&gt;26</strong></td>
</tr>
<tr>
<td>0x12</td>
<td>18</td>
<td>Internal Mic in</td>
<td><strong>8-&gt;35-&gt;18</strong></td>
</tr>
</tbody>
</table>
<ul>
<li>最终的<code>ConfigData</code>数据:</li>
</ul>
<p><code>01271c20 01271d01 01271ea6 01271f90 01371cf0 01371d00 01371e00 01371f40 01471c40 01471d01 01471e17 01471f90 01470c02 01871cf0 01871d00 01871e00 01871f40 01971c10 01971d10 01971e8b 01971f02 01a71cf0 01a71d00 01a71e00 01a71f40 01b71cf0 01b71d00 01b71e00 01b71f40 01d71cf0 01d71d00 01d71e00 01d71f40 01e71cf0 01e71d00 01e71e00 01e71f40 02171c30 02171d10 02171e2b 02171f02 02170c02</code><br>下一步,我们就要将这些数据<code>放</code>进<code>AppleALC</code>相应的位置,让它发挥作用.</p>
<h2 id="下载AppleALC"><a href="#下载AppleALC" class="headerlink" title="下载AppleALC"></a>下载<code>AppleALC</code></h2><p>操作步骤:</p>
<ol>
<li><p>创建<code>AppleALC</code>的本地仓库的克隆版本:</p>
<ul>
<li><p>使用<code>git</code>命令,更多<code>git</code>命令的用法请参考<a href="http://www.bootcss.com/p/git-guide/" target="_blank" rel="external">git使用简易指南</a>:</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir ~/git <span class="comment"># 在家目录下新建立`git`目录</span></div><div class="line"><span class="built_in">cd</span> ~/git    <span class="comment"># 进入`git`目录</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/vit9696/AppleALC   <span class="comment"># 克隆AppleALC到本地</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<pre><code>* 或者通过浏览器下载 [AppleALC最新版](https://github.com/vit9696/AppleALC/archive/master.zip) 
</code></pre><ol>
<li>打开<code>AppleALC</code>目录,进入<code>Resources</code>目录,你会发现这里面<code>躺</code>着截止到目前所支持的声卡的全部型号.我的声卡是<code>ALC256</code>,我就点击<code>ALC256</code>为便于理解,我将除了<code>ALC256</code>之外的其它型号的声卡目录全部删除了,它看起来如下图所示:<br><img src="http://ous2s14vo.bkt.clouddn.com/ALC_Folder.png" alt="ALC_Folder">我们会发现该目录下包括了一个定义文件<code>Info.plist</code>,打开<code>Info.plist</code>,你会发现,它定义了一个声卡驱动所需要的数据,<code>CodecID</code>后面的<code>598</code>是<code>ALC256</code>的<code>0x256</code>的10进制数值,<code>CodecName</code>是声卡名称的描述,这里是<code>ALC256(3246)</code>,接下来是<code>Files</code>,它分成两部分,一部分是<code>Layouts</code>,它定义声卡设备的布局,另一部分是<code>Platforms</code>,它定义声卡的平台注入,包括有效节点和路径的定义.<br><img src="http://ous2s14vo.bkt.clouddn.com/ALC256_Info.plist.png" alt="ALC256_Info.plist"></li>
</ol>
<p>三个<code>layout</code>开头的文件以及三个<code>Platforms</code>开头的文件,<code>Platforms</code>为路径定义文件.其中<code>layout13.xml.zlib</code> <code>layout28.xml.zlib</code> <code>layout56.xml.zlib</code>就是注入的id,只是你的声卡需要注入的是哪个ID才能获得最佳效果,还需要分析其它的数据.</p>
<h2 id="如何找出适合你的id"><a href="#如何找出适合你的id" class="headerlink" title="如何找出适合你的id"></a>如何找出适合你的id</h2><p>通过制作几十个声卡仿冒的驱动,我发现找出注入的id还是有些窍门的,比如说我可以通过<code>PinConfigs.kext</code>的<code>Info.plist</code>,将同一型号的声卡的<code>ConfigData</code>都找出来,方法:</p>
<ul>
<li>根据上面整理的声卡基础资料将<code>Address</code>不为<code>0</code>的排除出去</li>
<li>剩下的<code>LayoutID</code>里,再通过<code>ConfigData</code>将有效节点的数据留下,无效的排除,这样剩下来的<code>LayoutID</code>也就没几个了</li>
<li>最后,通过<code>PlatformsID</code>,找出有效节点及路径,最终确定注入的id</li>
<li>需要注意的是,某些型号的声卡的注入id可以是唯一的,也可以是多个,这些都需要通过分析数据进行确认</li>
</ul>
<blockquote>
<p>这里插句题外话:之前给群友做声卡仿冒的时候,<code>ALC269</code>和<code>ALC887</code>我都是直接绕路走的,或者让群友用<code>VoodooHDA</code>,或者直接拒绝.现在可以使用排除法,很快就能找到注入的id</p>
</blockquote>
<p>更新于:11-21-2017 22:30</p>
<h1 id="如何修改layout和Platforms数据"><a href="#如何修改layout和Platforms数据" class="headerlink" title="如何修改layout和Platforms数据"></a>如何修改<code>layout</code>和<code>Platforms</code>数据</h1><blockquote>
<p>上文中我们提到了通过<code>PlatformsID</code>,找出有效节点及路径,最终确定注入的id</p>
</blockquote>
<p>如何确认路径是否正确,我应该怎么做呢?先打开<code>Platforms</code>文件,需要用到的工具:<code>zlib转换器.app</code>.<br>操作方法:</p>
<ul>
<li><p>打开<code>zlib转换器.app</code>,把需要解压缩的后缀为.zlib的文件拖进窗口里,按下<code>CONVERT</code>按钮,就会在当前的目录下生成去掉了.zlib后缀的可以编辑的.xml文件了.相应地,当你编辑好了的.xml文件,拖进窗口里,按下<code>CONVERT</code>按钮,会在当前目录下生成.zlib后缀的文件了.</p>
<video width="640" height="480" controls><br><source src="http://ous2s14vo.bkt.clouddn.com/zlib.mp4"><br></video>

</li>
</ul>
<p>使用工具<code>PlistEdit Pro.app</code>打开<code>Platforms56.xml</code>,依次打开<code>PathMap-&gt;0-&gt;0-&gt;0</code>,这里的<code>NodeID</code>就是节点id.为便于理解,我将<code>Mic Int</code>的路径做了说明,如下图显示:<br><img src="http://ous2s14vo.bkt.clouddn.com/Platforms_edit2.png" alt="Platforms_edit2"></p>
<h1 id="如何新建一个注入id"><a href="#如何新建一个注入id" class="headerlink" title="如何新建一个注入id"></a>如何新建一个注入id</h1><h1 id="编译AppleALC"><a href="#编译AppleALC" class="headerlink" title="编译AppleALC"></a>编译AppleALC</h1><p>使用xcode<br>通过lilu联合编译</p>
<h1 id="注入id"><a href="#注入id" class="headerlink" title="注入id"></a>注入id</h1><h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><h2 id="检查AppleALC是否正确加载"><a href="#检查AppleALC是否正确加载" class="headerlink" title="检查AppleALC是否正确加载"></a>检查<code>AppleALC</code>是否正确加载</h2><p>打开终端,输入命令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kextstat | grep AppleALc</div></pre></td></tr></table></figure>
<p>显示内容如下:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">kextstat | grep AppleALC</div><div class="line">   36    0 0xffffff7f8331b000 0xb0000    0xb0000</div><div class="line">       as.vit9696.AppleALC (1.2.1) </div><div class="line">       7CDA2635-8BE4-36E1-B882-8CA3B90284F3 &lt;35 7 5 4 3 2 1&gt;</div></pre></td></tr></table></figure>
<p>我们可以看到<code>AppleALC</code>驱动已经被正确加载,版本是<code>1.2.1</code>,如果没有内容输出,那么就有可能没有加载.通常这种情况是因为<code>Lilu</code>的版本引起的,可以尝试使用<code>Lilu</code> Debug版本.</p>
<h2 id="检查注入id是否正确"><a href="#检查注入id是否正确" class="headerlink" title="检查注入id是否正确"></a>检查注入id是否正确</h2><p>打开终端,输入命令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ioreg -l | grep layout-id</div></pre></td></tr></table></figure>
<p>显示内容如下:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">~ % ioreg -l <span class="params">| grep layout-id</span></div><div class="line"><span class="params">    |</span> <span class="params">|   |</span> <span class="params">|   "layout-id" = &lt;38000000&gt;</span></div><div class="line"><span class="params">    |</span> <span class="params">|   |</span>             <span class="params">| |</span>   <span class="string">"IOAudioEngineDeviceDescription"</span> = &#123;</div><div class="line">    <span class="string">"num-internal-mics"</span>=<span class="number">1</span>,</div><div class="line">    <span class="string">"driver digital input gain"</span>=<span class="number">0</span>,</div><div class="line">    <span class="string">"layout-id"</span>=<span class="number">56</span>,</div><div class="line">    <span class="string">"post-processing input gain"</span>=<span class="number">25</span>,</div><div class="line">    <span class="string">"VP-pregain"</span>=<span class="number">25</span>&#125;</div></pre></td></tr></table></figure>
<p>为了便于讲解,我将内容做了换行处理.<br>其中的<code>&quot;layout-id&quot;=56</code>就是指注入id是 <code>56</code> ,而<code>&lt;38000000&gt;</code>是<code>56</code>的16进制</p>
<h2 id="检查PinConfigurations"><a href="#检查PinConfigurations" class="headerlink" title="检查PinConfigurations"></a>检查<code>PinConfigurations</code></h2><p>使用<code>IORegistryExplorer.app</code>,找到<code>HDEF@1F,3</code>,右侧的<code>PinConfigurations</code>就是最终的四个节点的数值,同时我们发现其它的节点已经不存在了,这样的结果正是我们需要的.<br><img src="http://ous2s14vo.bkt.clouddn.com/ioreg_pinconfigurations.png" alt="ioreg_pinconfigurations"></p>
<h1 id="其它问题"><a href="#其它问题" class="headerlink" title="其它问题"></a>其它问题</h1><p>耳机切换<br>睡眠唤醒<br>去除底噪</p>
<h2 id="声卡驱动了-音量调节的图标也显示正常-就是不发声怎么办"><a href="#声卡驱动了-音量调节的图标也显示正常-就是不发声怎么办" class="headerlink" title="声卡驱动了,音量调节的图标也显示正常,就是不发声怎么办"></a>声卡驱动了,音量调节的图标也显示正常,就是不发声怎么办</h2><p>如果您的声卡使用了AppleALC,也注入了正确的ID后不发声怎么办呢?这个问题就出现在有效节点和路径不正确上面.<br>所谓条条大路通罗马,我们总不能在同一棵树上吊死吧.现在可以请出<a href="https://github.com/daliansky/VoodooHDA-2.9.0-Clover-V10" target="_blank" rel="external">VoodooHDA</a>万能声卡驱动程序<a href="https://github.com/daliansky/VoodooHDA-2.9.0-Clover-V10/raw/master/VoodooHDA_2.9.0_Clover-V11.dmg" target="_blank" rel="external">下载链接</a>了,说它万能是不正确的,如果它万能了估计就没<code>AppleALC</code>啥事儿了吧.这里可以借助<code>VoodooHDA</code>自带的应用程序:<a href="https://github.com/daliansky/VoodooHDA-2.9.0-Clover-V10/raw/master/getdump" target="_blank" rel="external">getdump</a>,使用方法:打开终端,输入命令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo cp ~/Downloads/getdump /usr/<span class="built_in">local</span>/bin  <span class="comment"># 将getdump命令复制到/usr/local/bin目录下</span></div><div class="line">sudo chmod +x /usr/<span class="built_in">local</span>/bin/getdump    <span class="comment"># 为getdump添加执行权限</span></div><div class="line">getdump &gt; ~/Desktop/voodoo_dump.txt</div></pre></td></tr></table></figure>
<p>用它可以生成一份<code>voodoo_dump.txt</code>的文件,里面会有两段以<code>DUMPING Playback/Record Paths</code>开头的文字描述,这里面即包括了有效节点,同时也包括了有效的路径<br><img src="http://ous2s14vo.bkt.clouddn.com/path1.png" alt="path1"><br><img src="http://ous2s14vo.bkt.clouddn.com/path2.png" alt="path2"><br>从上面的两张截图中,可以将有效的节点和路径整理出下面的表格:</p>
<table>
<thead>
<tr>
<th>有效节点</th>
<th>10进制</th>
<th>设备名称</th>
<th>路径</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x14</td>
<td>20</td>
<td>Speaker out</td>
<td><strong>20-&gt;12-&gt;2</strong></td>
</tr>
<tr>
<td>0x21</td>
<td>33</td>
<td>HP out</td>
<td><strong>33-&gt;13-&gt;3</strong></td>
</tr>
<tr>
<td>0x19</td>
<td>25</td>
<td>Headset Mic in</td>
<td><strong>8-&gt;35-&gt;24</strong> <strong>8-&gt;35-&gt;29备用</strong></td>
</tr>
<tr>
<td>0x12</td>
<td>18</td>
<td>Internal Mic in</td>
<td><strong>9-&gt;34-&gt;18</strong> <strong>9-&gt;34-&gt;29备用</strong></td>
</tr>
</tbody>
</table>
<p>有了这个表格,再结合<code>configdata</code>,找出有效的ID,编译<code>AppleALC</code>,注入ID并使用声卡驱动.</p>
<h1 id="HDA工具下载及使用"><a href="#HDA工具下载及使用" class="headerlink" title="HDA工具下载及使用"></a>HDA工具下载及使用</h1><p>制作声卡仿冒需要用到的工具,我已经同步到仓库,您可以打包下载也可以通过git同步到本地</p>
<ul>
<li>下载链接:<a href="https://github.com/daliansky/dell7000/tree/master/hda-tools" target="_blank" rel="external">https://github.com/daliansky/dell7000/tree/master/hda-tools</a></li>
<li><p>如何安装</p>
<ul>
<li><p>将<code>hda-tools</code>目录下的所有文件复制到<code>/usr/local/bin</code>下,如果<code>/usr/local/bin</code>目录不存在,需要新建立,命令如下:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo mkdir /usr/<span class="built_in">local</span>/bin   <span class="comment"># 建立/usr/local/bin子目录</span></div><div class="line">sudo cp ~/Downloads/hda-tools/* /usr/<span class="built_in">local</span>/bin  <span class="comment"># 将hda-tools目录下所有的应用程序复制到/usr/local/bin目录下</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>如何使用</p>
<ul>
<li><p>打开终端,输入命令,直接执行.例如:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">verbit.sh codec<span class="comment">#0 &gt; codec_dump.txt    # 有效节点格式化</span></div><div class="line">codecgraph codec<span class="comment">#0    # 自动生成pathmap图,文件位于codec#0相同目录下</span></div><div class="line">hda-verb 0x19 0x707 0x20    <span class="comment"># 耳机睡眠唤醒无声修正</span></div><div class="line">widget_dump.sh  <span class="comment"># 读取SET_PIN_WIDGET_CONTROL数值</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="关于打赏"><a href="#关于打赏" class="headerlink" title="关于打赏"></a>关于打赏</h1><p>您的支持就是我更新的动力！<br>如果不希望看到博主停更的话，请点击下方的 <code>打赏</code> 支持一下，有钱的捧个钱场，没钱的捧个人场，谢谢大家！</p>
<h1 id="QQ群"><a href="#QQ群" class="headerlink" title="QQ群:"></a>QQ群:</h1><p>331686786 <a href="http://shang.qq.com/wpa/qunwpa?idkey=db511a29e856f37cbb871108ffa77a6e79dde47e491b8f2c8d8fe4d3c310de91" target="_blank" rel="external">一起黑苹果</a></p>

      
    </div>
    
    
    

    
    
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="DalianSky 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="DalianSky 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/AppleALC/" rel="tag"><i class="fa fa-tag"></i> AppleALC</a>
          
            <a href="/tags/AppleHDA/" rel="tag"><i class="fa fa-tag"></i> AppleHDA</a>
          
            <a href="/tags/声卡仿冒/" rel="tag"><i class="fa fa-tag"></i> 声卡仿冒</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Clover-Patched-Desktop-AppleHDA-Realtek-ALC-Audio.html" rel="next" title="使用CloverALC给AppleHDA打补丁，适用于台式机">
                <i class="fa fa-chevron-left"></i> 使用CloverALC给AppleHDA打补丁，适用于台式机
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Use-HIDPI-to-solve-sleep-wake-up-black-screen,-Huaping-and-connect-the-external-monitor-the-correct-posture.html" rel="prev" title="使用HIDPI解决睡眠唤醒黑屏、花屏及连接外部显示器的正确姿势">
                使用HIDPI解决睡眠唤醒黑屏、花屏及连接外部显示器的正确姿势 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">DalianSky</p>
              <p class="site-description motion-element" itemprop="description">一些平时学习笔记以及搜集到的好的文章</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">45</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">122</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/rss2.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/daliansky" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://www.jianshu.com/u/df9143008845" target="_blank" title="简书">
                    
                      <i class="fa fa-fw fa-heartbeat"></i>简书</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://shang.qq.com/wpa/qunwpa?idkey=db511a29e856f37cbb871108ffa77a6e79dde47e491b8f2c8d8fe4d3c310de91" target="_blank" title="QQ">
                    
                      <i class="fa fa-fw fa-qq"></i>QQ</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#大纲-写作中"><span class="nav-number">1.</span> <span class="nav-text">大纲,写作中</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">2.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#提取codec"><span class="nav-number">3.</span> <span class="nav-text">提取codec</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#通过linux提取codec"><span class="nav-number">3.1.</span> <span class="nav-text">通过linux提取codec</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#制作Ubuntu-Linux启动U盘"><span class="nav-number">3.1.1.</span> <span class="nav-text">制作Ubuntu Linux启动U盘:</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#制作Ubuntu-Linux安装盘"><span class="nav-number">3.1.1.1.</span> <span class="nav-text">制作Ubuntu Linux安装盘</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#提取codec-1"><span class="nav-number">3.2.</span> <span class="nav-text">提取codec</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#整理有效节点"><span class="nav-number">4.</span> <span class="nav-text">整理有效节点</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#通过Linux找出有效的节点"><span class="nav-number">5.</span> <span class="nav-text">通过Linux找出有效的节点</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#赞"><span class="nav-number">6.</span> <span class="nav-text">赞</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#整理有效路径"><span class="nav-number">7.</span> <span class="nav-text">整理有效路径</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#整理ConfigData"><span class="nav-number">8.</span> <span class="nav-text">整理ConfigData</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#通过PinConfigs提取ConfigData"><span class="nav-number">8.1.</span> <span class="nav-text">通过PinConfigs提取ConfigData</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#通过codec里面的Pin-Default提取并整理"><span class="nav-number">8.2.</span> <span class="nav-text">通过codec里面的Pin Default提取并整理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修正PinDefault-并生成ConfigData"><span class="nav-number">8.3.</span> <span class="nav-text">修正PinDefault,并生成ConfigData</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#找出适合你的id"><span class="nav-number">9.</span> <span class="nav-text">找出适合你的id</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#下载AppleALC"><span class="nav-number">9.1.</span> <span class="nav-text">下载AppleALC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如何找出适合你的id"><span class="nav-number">9.2.</span> <span class="nav-text">如何找出适合你的id</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#如何修改layout和Platforms数据"><span class="nav-number">10.</span> <span class="nav-text">如何修改layout和Platforms数据</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#如何新建一个注入id"><span class="nav-number">11.</span> <span class="nav-text">如何新建一个注入id</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#编译AppleALC"><span class="nav-number">12.</span> <span class="nav-text">编译AppleALC</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#注入id"><span class="nav-number">13.</span> <span class="nav-text">注入id</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#测试"><span class="nav-number">14.</span> <span class="nav-text">测试</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#检查AppleALC是否正确加载"><span class="nav-number">14.1.</span> <span class="nav-text">检查AppleALC是否正确加载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#检查注入id是否正确"><span class="nav-number">14.2.</span> <span class="nav-text">检查注入id是否正确</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#检查PinConfigurations"><span class="nav-number">14.3.</span> <span class="nav-text">检查PinConfigurations</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#其它问题"><span class="nav-number">15.</span> <span class="nav-text">其它问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#声卡驱动了-音量调节的图标也显示正常-就是不发声怎么办"><span class="nav-number">15.1.</span> <span class="nav-text">声卡驱动了,音量调节的图标也显示正常,就是不发声怎么办</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HDA工具下载及使用"><span class="nav-number">16.</span> <span class="nav-text">HDA工具下载及使用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#关于打赏"><span class="nav-number">17.</span> <span class="nav-text">关于打赏</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#QQ群"><span class="nav-number">18.</span> <span class="nav-text">QQ群:</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">DalianSky</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div><span class="post-meta-divider">|</span>Hosted by <a href="https://pages.coding.me">Coding Pages</a>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("u1cCU9pnOGMB1PPY04TV5JA6-gzGzoHsz", "qaUBhUG8XJqpiXX1C6UopuoP");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
  

  

  

  

</body>
</html>
